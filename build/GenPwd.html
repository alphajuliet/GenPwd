<!DOCTYPE html>
<html> 
	<head> 
		<title>GenPwd</title> 
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
		<script type="text/javascript">
		<!--
		Info = {
				name: "GenPwd",
				author: "AndrewJ", 
				version: "2.14",
				date: "2016-01-25",
				info: "GenPwd is a very simple password generator.",
				appendTo: function(tagName) {
					var str = "<div>";
					str += "<span class='title'>" + this.name + "</span>";
					str += "&nbsp;<span class='description'>v" + this.version + "</span>";
					str += "</div>";
					$(tagName).append(str);
				},
				aboutText: function() {
					str = this.name + " v" + this.version;
					str += ", last modified: " + this.date;
					str += " by: " + this.author + ".\n\n";
					str += this.info;
					return str;
				}
			}
			
			var nwords = 10;
			
			// Capitalise a string
			String.prototype.capitalise = function () {
				return this.substr(0,1).toUpperCase() + this.substr(1);
			}
			
			// Generate a random number between 0 and n-1
			Math.randomN = function (n) {
				return Math.floor(n * Math.random());
			}
			
			// Return a random element from an array
			Array.prototype.random = function () {
				return this[Math.randomN(this.length)];
			}
			
			// Utility function		
			doTimes = function (n, fn) {
				for (var i=0; i<n; i++)
					fn();
				return n;
			}
			
			// Left zero pad numbers to 2 digits
			pad2 = function (n) { 
				return (n < 10 ? "0"+n : n);
			}
			
			// List generators returning functions to call
			RandomList = function (t) {
				return function () {
					return t.random();
				}
			},
			
			WeightedList = function (t) {
				var expandedList = [];
				$.each(t, function (key, value) {
					doTimes(value, function () {
						expandedList.push(key);
					});
				});
				return function () {
					return expandedList.random();
				}
			},
			
			//---------------------------------
			// Namespace: GenPwd
			GenPwd = {
				
				// Generators
				generator1: {	
					c1: WeightedList({"b":2,"bl":1,"br":1,"c":2,"cr":1,"ch":2,"cl":1,"d":2,"f":2,"fl":1,"fr":1,"g":2,"gl":1,"gr":1,"h":1,"j":2,"k":2,"l":2,"m":3,"n":2,"p":2,"pl":1,"pr":1,"qu":1,"r":2,"s":3,"sh":2,"sk":1,"sl":1,"sm":1,"sn":1,"st":2,"str":1,"t":3,"th":2,"thr":1,"tr":2,"tw":1,"v":2,"w":1,"z":2}),
					c2: RandomList(["b","bl","br","cr","ch","cl","d","f","fl","fr","g","gg", "gl","gr","h","j","k","l","m","n","p","pl","pp","pr","pt","qu","r","s","sh","sk","sl","sm","sn","st","str","t","th","thr","tr","tw","v","w","z"]),
					c3: WeightedList({"b":1,"ch":1,"ck":1,"ct":1,"d":2,"dd":1,"f":1,"ff":1,"ft":1,"g":1,"k":1,"l":2,"ll":1,"lb":1,"ld":1,"lm":1,"ln":1,"lp":1,"lt":1,"m":3,"mp":1,"mt":1,"n":3,"nd":1,"ng":1,"nn":1,"nt":1,"p":2,"pp":1,"pt":1,"rd":1,"rg":1,"rk":1,"rn":1,"rr":1,"rs":1,"rt":1,"s":3,"sh":1,"ss":2,"st":2,"t":3,"tt":2,"th":2,"v":2,"wn":1}),
					v1: WeightedList({"a":5,"aa":1, "ai":1,"e":5,"ea":1,"ee":1, "i":5,"o":5,"oo":2,"u":2}),
					v2: WeightedList({"a":5, "e":5, "i":5, "ia":1, "o":5, "oa":1, "oo":2, "u":2, "ua":1}),
					v3: WeightedList({"a":5,"ao":1,"e":5,"ea":1,"ee":2,"eo":1,"i":2,"ia":2, "io":2,"o":5, "oa":2, "oo":2,"ow":2,"ua":1, "uo":1,"y":5}),
					p:  RandomList(["!","#","$","^","*","&", "+","@","-","=","/","~","?","\\","%","[","]","{","}","(",")"]),
          cap: function (s) { return ($("#capitals:checked").length > 0 ? s.capitalise() : s); },
          punc: function () { return ($("#punctuation:checked").length > 0 ? this.p() : ""); },
          num: function () { return ($("#numbers:checked").length > 0 ? pad2(Math.randomN(99)) : ""); },
					randomWord: function () {
						var R = this;
						var w = "";
						c = Math.randomN(8);
						switch (c) {
							case 0:  w = R.c1() + R.v1() + R.punc() + R.cap(R.c2()) + R.v2() + R.c3(); break;
							case 1:  w = R.v1() + R.cap(R.c1()) + R.punc() + R.v2() + R.c3(); break;
							case 2:  w = R.c1() + R.v1() + R.punc() + R.cap(R.c3()) + R.v3(); break;
							case 3:  w = R.v1() + R.c1() + R.v1() + R.cap(R.c3()) + R.v3() + R.punc(); break;
							case 4:  w = R.c1() + R.v1() + R.cap(R.c1()) + R.v2() + R.c3() + R.punc(); break;
							case 5:  w = R.punc() + R.cap(R.c1()) + R.v2() + R.c3() + R.v3(); break;
							case 6:  w = R.c1() + R.v1() + R.cap(R.c2()) + R.punc() + R.v2() + R.c3(); break;
							case 7:  w = R.c1() + R.v1() + R.cap(R.c1()) + R.v1() + R.c1() + R.v1() + R.punc(); break
							default: w = R.c1() + R.v1() + R.punc() + R.cap(R.c3()) + R.v3(); break;
						}
						w = (Math.randomN(2) < 1) ? w + R.num() : R.num() + w;
						// return c + ": " + w;
						return w;
					},
				},
				
				// Pseudo-Japanese style
				generator2: {
					c1: WeightedList({"k":5,"g":5,"t":5,"d":5,"s":5,"z":4,"h":2,"b":3,"p":2,"n":3,"r":5,"m":5,"y":2,
            "gy":1,"j":1,"sh":1,"ch":1,"ky":1,"hy":1,"ry":1,"my":1,"ny":1,"by":1,"py":1}),
					v1: WeightedList({"a":2,"i":1,"u":2,"e":1,"o":2, "ou":1}),
					p:  RandomList(["!","#","$","^","*","&", "+","@","-","=","/","~","?","\\","%","[","]","{","}","(",")"]),
          cap: function (s) { return ($("#capitals:checked").length > 0 ? s.capitalise() : s); },
          punc: function () { return ($("#punctuation:checked").length > 0 ? this.p() : ""); },
          num: function () { return ($("#numbers:checked").length > 0 ? pad2(Math.randomN(99)) : ""); },
					randomWord: function () {
						var R = this;
						var w;
						c = Math.randomN(5);
						switch (c) {
							case 0: w = R.c1() + R.v1() + R.punc() + R.cap(R.c1()) + R.v1() + R.c1() + R.v1(); break;
							case 1: w = R.c1() + R.v1() + "n" + R.punc() + R.cap(R.c1()) + R.v1() + R.c1() + R.v1(); break;
							case 2: w = R.c1() + R.v1() + R.punc() + R.c1() + R.v1() + R.cap(R.c1()) + R.v1() + "n"; break;
							case 3: w = R.c1() + R.v1() + R.punc() + R.cap(R.c1()) + R.v1(); break;
							default: w = R.c1() + R.v1() + R.cap(R.c1()) + R.v1() + "n";
						}
						w = (Math.randomN(2) < 1) ? w + R.num() : R.num() + w;
						w = w.replace(/[Tt]i/, "chi");
						w = w.replace(/[Ss]i/, "shi");
						w = w.replace(/[Hh]u/, "fu");
						w = w.replace(/[Cc]fu/, "chu"); // fix from the previous rule when it matches "chu"
						w = w.replace(/[Ss]fu/, "shu"); // fix from the previous rule when it matches "shu"
						w = w.replace(/[Tt]u/, "tsu");
						w = w.replace(/[Ss]he/, "sho");
						w = w.replace(/(\wy)[ie]/, "$1o");
						return w;
					},
				},
				
				// Public methods

				// Get the state of a form element
				getState: function (id) {
					return $(id).attr("checked");
				},
				
				generate: function () {
					var generator = eval("GenPwd." + $("#gen").val());
					$("#output").empty();
					for (var i=0; i < nwords; i++) {
						elt = $("<div class='word'></div>").append(generator.randomWord());
						$("#output").append(elt);
						//$("#output").append("<br/>");
					}
				},
				
				initialise: function () {
					Info.appendTo("#header");
				}		
			}			
			
			// $(GenPwd.initialise);
			$(document).ready(function() {
					GenPwd.initialise()
			});
			
    -->
		</script> 
		<noscript><p>GenPwd requires JavaScript to be enabled</p></noscript> 
        
    <style type="text/css"> 
		<!--
      body { 
      	font-family: Helvetica Neue, Geneva, Arial, sans-serif; 
      	font-weight: lighter;
      	font-size: 10pt;
      	margin: 3% 5%;
      	width: 90%;
      }
      #header p { margin: 2pt; }
			#header .title { font-size: 20pt; color: #639; }
			#container { padding-top: 5pt; }
      #output { margin-top: 5pt; }
      #output .word { font-size: 125%; margin: 3pt 0pt; padding-left: 5pt; }
      #output .word:nth-child(even) { background-color: #eef; } 
      #controls { 
        background-color: #ddf; 
        border-radius: 5px;
        padding: 2pt;
      }
			#controls div { display: inline; margin: 4pt 4pt; }
			.button { 
				padding: 4pt 6pt;
				margin: 6pt 4pt;
				background-color: #6ff; 
				border: solid 1px #666; 
        border-radius: 5px;
			}
			.button:hover { background-color: #f9f; }
			.description { font-size: 80%; font-weight: normal; color: #ccc; }
			@media screen {
        body { 
          font-family: Helvetica;
          max-width: 450px; 
        }
			}
			@media handheld {
				body { -webkit-text-size-adjust:none; padding: 5px; }
				div { width: 100%!important; margin: 0pt !important; }
			}
        -->
    </style>
       
		<meta name="viewport" content="width=device-width,user-scalable=no" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<link rel="icon" href="http://alphajuliet.com/images/favicon.ico"/>
		<link rel="apple-touch-icon" sizes="57x57" href="http://alphajuliet.com/images/maitre-57x57.png" />
		<link rel="apple-touch-icon" sizes="72x72" href="http://alphajuliet.com/images/maitre-72x72.png" />
		<link rel="apple-touch-icon" sizes="114x114" href="http://alphajuliet.com/images/maitre-114x114.png" />
	</head> 
	<body> 
		<div id="header"></div> 
		<div id="container"> 
			<div id="controls"> 
				<div><input type="checkbox" id="punctuation" checked /> Punctuation</div> 
				<div><input type="checkbox" id="numbers" checked /> Numbers </div>
				<div><input type="checkbox" id="capitals" checked /> Capitals </div>
				<div>
					<select id="gen">
						<option value="generator1">generator1</option>
						<option value="generator2" selected="true">generator2</option>
					</select>
				</div>
				<div><input class="button" type="button" value="Go!" onclick="GenPwd.generate();"/></div> 
			</div> 
			<div id="output"><div>Click on Go!</div></div> 
		</div> 
		<div id="footer"> 
		</div> 
	</body> 
</html>
